<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Billings - PeningBot</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="stylesheet" href="/assets/css/dashboard.css">
    <link rel="stylesheet" href="/assets/css/device-settings.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
    <div class="background-gradient"></div>

    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <span class="logo-icon">ğŸ¤–</span>
                <span class="logo-text">
                    <span class="logo-dev">Dev</span><span class="logo-muse">Muse</span>
                </span>
            </div>
        </div>

        <nav class="sidebar-nav">
            <a href="/dashboard.html" class="nav-item">
                <span class="nav-icon">ğŸ“Š</span>
                <span class="nav-text">Dashboard</span>
            </a>
            <a href="/device-settings.html" class="nav-item">
                <span class="nav-icon">ğŸ“±</span>
                <span class="nav-text">Device Settings</span>
            </a>
            <a href="/profile.html" class="nav-item">
                <span class="nav-icon">ğŸ‘¤</span>
                <span class="nav-text">Profile</span>
            </a>
            <a href="/billings.html" class="nav-item active">
                <span class="nav-icon">ğŸ’³</span>
                <span class="nav-text">Billings</span>
            </a>
            <a href="/packages.html" class="nav-item" id="packagesTab" style="display: none;">
                <span class="nav-icon">ğŸ“¦</span>
                <span class="nav-text">Packages</span>
            </a>
            <a href="/set-stage.html" class="nav-item">
                <span class="nav-icon">ğŸ¯</span>
                <span class="nav-text">Set Stage</span>
            </a>
            <a href="/flow-builder.html" class="nav-item">
                <span class="nav-icon">ğŸ”€</span>
                <span class="nav-text">Flow Builder</span>
            </a>
            <a href="/flow-manager.html" class="nav-item">
                <span class="nav-icon">ğŸ“‹</span>
                <span class="nav-text">Flow Manager</span>
            </a>
            <a href="/chatbot-ai.html" class="nav-item">
                <span class="nav-icon">ğŸ¤–</span>
                <span class="nav-text">Chatbot AI</span>
            </a>
            <a href="/whatsapp-bot.html" class="nav-item">
                <span class="nav-icon">ğŸ’¬</span>
                <span class="nav-text">WhatsApp Bot</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <div class="user-info">
                <div class="user-avatar">ğŸ‘¤</div>
                <div class="user-details">
                    <div class="user-email" id="userEmail">Loading...</div>
                    <button class="btn-logout" onclick="logout()">Logout</button>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <div class="content-wrapper">
            <!-- Page Header -->
            <div class="page-header">
                <div>
                    <h1 class="page-title">ğŸ’³ Billings & Payments</h1>
                    <p class="page-subtitle">Manage your subscription and view payment history</p>
                </div>
            </div>

            <!-- Pricing Package Card -->
            <div id="packagesContainer" style="margin-bottom: 2rem;">
                <!-- Packages will be loaded dynamically here -->
                <div class="empty-state">
                    <div class="empty-state-icon">ğŸ“¦</div>
                    <h2 class="empty-state-title">Loading Packages...</h2>
                    <p class="empty-state-text">Please wait while we load available packages</p>
                </div>
            </div>

            <!-- Order History -->
            <div class="page-header" style="margin-top: 2rem;">
                <div>
                    <h2 style="font-size: 1.5rem; color: white; margin: 0;">ğŸ“œ Order History</h2>
                </div>
            </div>

            <!-- Date Filter -->
            <div class="card" style="margin-bottom: 1.5rem;">
                <div class="card-body">
                    <div style="display: flex; gap: 1rem; align-items: end; flex-wrap: wrap;">
                        <div style="flex: 1; min-width: 200px;">
                            <label style="display: block; color: var(--netflix-light-gray); margin-bottom: 0.5rem; font-size: 0.9rem;">From Date</label>
                            <input type="date" id="fromDate" style="
                                width: 100%;
                                padding: 0.75rem;
                                background: rgba(255, 255, 255, 0.05);
                                border: 1px solid rgba(255, 255, 255, 0.1);
                                border-radius: 6px;
                                color: white;
                                font-size: 0.95rem;
                            ">
                        </div>
                        <div style="flex: 1; min-width: 200px;">
                            <label style="display: block; color: var(--netflix-light-gray); margin-bottom: 0.5rem; font-size: 0.9rem;">To Date</label>
                            <input type="date" id="toDate" style="
                                width: 100%;
                                padding: 0.75rem;
                                background: rgba(255, 255, 255, 0.05);
                                border: 1px solid rgba(255, 255, 255, 0.1);
                                border-radius: 6px;
                                color: white;
                                font-size: 0.95rem;
                            ">
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <button onclick="applyDateFilter()" style="
                                padding: 0.75rem 1.5rem;
                                background: linear-gradient(135deg, #e50914 0%, #b00710 100%);
                                border: none;
                                border-radius: 6px;
                                color: white;
                                font-weight: 600;
                                cursor: pointer;
                                transition: all 0.3s ease;
                            " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                                ğŸ” Filter
                            </button>
                            <button onclick="clearDateFilter()" style="
                                padding: 0.75rem 1.5rem;
                                background: rgba(255, 255, 255, 0.1);
                                border: 1px solid rgba(255, 255, 255, 0.2);
                                border-radius: 6px;
                                color: white;
                                font-weight: 600;
                                cursor: pointer;
                                transition: all 0.3s ease;
                            " onmouseover="this.style.background='rgba(255, 255, 255, 0.15)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'">
                                ğŸ”„ Clear
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Orders Table -->
            <div id="ordersLoading" class="empty-state">
                <div class="empty-state-icon">â³</div>
                <h2 class="empty-state-title">Loading Orders</h2>
                <p class="empty-state-text">Please wait while we fetch your order history...</p>
            </div>

            <div id="ordersError" class="empty-state" style="display: none;">
                <div class="empty-state-icon">âŒ</div>
                <h2 class="empty-state-title">Error Loading Orders</h2>
                <p class="empty-state-text" id="ordersErrorMessage"></p>
            </div>

            <div id="ordersEmpty" class="empty-state" style="display: none;">
                <div class="empty-state-icon">ğŸ“¦</div>
                <h2 class="empty-state-title">No Orders Yet</h2>
                <p class="empty-state-text">Make your first purchase to see your order history here</p>
            </div>

            <div id="ordersTableContainer" class="table-container" style="display: none;">
                <table class="devices-table">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Date</th>
                            <th>Product</th>
                            <th>Amount</th>
                            <th>Payment Method</th>
                            <th>Status</th>
                            <th>Receipt</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="ordersTableBody">
                        <!-- Orders will be inserted here -->
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <script src="/assets/js/common.js"></script>
    <script src="/assets/js/billings.js"></script>
</body>
</html>
